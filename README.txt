# 底値メモ - セットアップ方法

## ファイル構成
```
底値メモ/
├── index.html          # メインアプリ
├── manifest.json       # PWA設定
├── service-worker.js   # オフライン対応
└── icons/
    ├── icon-192.png
    └── icon-512.png
```

## iPhoneでPWAとして使う方法

### まず結論（よくある質問）
- `https://github.com/kusamoti1/Public`（リポジトリ画面）を開くだけでは、PWAとしては動きません。
- **GitHub Pages の公開URL** を開いてください。
  - このリポジトリなら通常は **`https://kusamoti1.github.io/Public/`** です。

### ステップ1: GitHub Pages を有効化する
1. リポジトリ `Public` を開く
2. **Settings > Pages** を開く
3. **Build and deployment** の Source を **Deploy from a branch** にする
4. Branch を **main / (root)** にして Save
5. 数十秒〜数分待って、表示された公開URL（例: `https://kusamoti1.github.io/Public/`）にアクセス

> 補足: 404になる場合は、反映待ちのことが多いので少し待って再読み込みしてください。

### ステップ2: ホーム画面に追加
1. iPhone の **Safari** で公開URLを開く
2. 下の共有ボタン（□↑）をタップ
3. **「ホーム画面に追加」** をタップ
4. 名前を確認して「追加」

これでアプリとして使えます。オフラインでも動作します。

## 代替: ローカルサーバで試す（PCとiPhoneが同じWi-Fi）
```bash
cd 底値メモ
python -m http.server 8080
```
iPhoneのSafariで `http://PCのIPアドレス:8080` にアクセス

## データについて
- データはiPhone/ブラウザのlocalStorageに保存
- ブラウザのデータを削除するとデータも消えます
- 定期的に「データ管理」タブからJSONエクスポートをおすすめします


## PRで「conflicts」が出るとき
- はい、ほとんどの場合は **PRブランチが古い（base/mainの更新を取り込めていない）** ことが原因です。
- これはアプリ不具合ではなく、**同じファイルの同じ行付近を別ブランチで編集した差分競合**です。

### スマホでの確認ポイント
1. PR画面を再読み込みする（Safariを引っ張って更新）
2. PRの最新コミット時刻が「今」の更新になっているか確認
3. まだ競合が出る場合は、`README.md` / `APP_IMPROVEMENT_PROPOSAL.md` など同じファイルを両方で触っている可能性が高い

### 解消方法（どちらか）
- GitHubの「対立を解決する」ボタンから解決してコミット
- もしくは、PRブランチに main の最新を取り込んでから再push

> 補足: 競合表示はキャッシュで古く見えることがあるため、再読み込み後に再確認してください。


## 画面が古くて「カメラ欄」が出ないとき
- 原因は、古いキャッシュ（Service Worker）が残っているケースが多いです。
- iPhone Safari で次を順に実施してください。
  1. 画面を再読み込み（下に引っ張って更新）
  2. いったんタブを閉じて、もう一度 `https://kusamoti1.github.io/Public/` を開く
  3. それでも古い場合は「設定 > Safari > 履歴とWebサイトデータを消去」後に再アクセス
- 更新後は「登録」タブのメモ欄の下に「レシート/商品写真（任意）」が表示されます。


## 入力の手間を減らす新機能
- カテゴリ選択: 「肉 > 豚 > 豚バラ」のように段階選択すると、品名候補が自動で入ります。
- レシート写真: バーコードガイド付きで撮影し、
  - 🔎 バーコード読取（無料）
  を使えます。
- 商品写真: 商品そのものの写真も別で保存できます（あとで見返しやすい）。


## 写真機能の使い方（わかりやすく）
- 「写真入力（任意）を開く」を押すと、
  - `📷 カメラで撮影`
  - `🖼 写真から選ぶ`（端末に保存済みの写真）
  の2つが使えます。
- 「バーコードをこの範囲に」は**撮影時の目安**です。
  - iPhoneの標準カメラ画面に枠が重なるわけではありません。
  - 撮影後のプレビューを見ながら使ってください。
