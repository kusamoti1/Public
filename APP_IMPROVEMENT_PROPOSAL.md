# 底値メモ: 現状整理と統合改善プラン

このドキュメントは、既存の改善案を1つに統合し、
**競合しにくい構成**で「次に何を作るか」を判断しやすくするための最新版です。

## 1) 現在できること（現状機能）

### 記録・閲覧
- 商品名 / 店舗 / 価格 / 単位 / 日付 / メモを登録
- 一覧検索（商品名・店舗）
- ソート（新しい順、古い順、安い順、高い順、品名順）
- 店舗フィルター
- 商品名ごとの最安値ラベル（底値）

### 編集・管理
- 詳細モーダルから編集・削除
- JSONエクスポート / インポート
- 全件削除

### 利用形態
- PWAとしてホーム画面追加・オフライン利用
- ブラウザ内保存（localStorage）

---

## 2) いまの課題（優先度: 高）

1. **比較精度の課題**
   - 容量違い（例: 300gと500g）でも同じ商品名なら単純比較される
2. **入力速度の課題**
   - 買い物中の入力回数が多く、片手運用で時間がかかる
3. **データ保全の課題**
   - localStorage依存のため、ブラウザデータ消去の影響を受ける
4. **容量の課題（写真対応後）**
   - 画像保存で容量上限に達しやすい

---

## 3) 改善方針（優先度順）

### A. 比較精度アップ
- 容量（g/ml/個）と税区分（税込/税抜）を保持
- 単価（100g・100ml・1個）を自動計算
- 最安値判定を「実売価格 / 単価」で切替可能にする

### B. 入力体験アップ
- 前回値再利用（店名・単位）
- 商品名サジェスト
- 「前回と同じで登録」ボタン
- よく買う商品のピン留め

### C. データ保全アップ
- IndexedDB移行（画像保存を含む）
- 定期バックアップ通知
- 復元しやすいエクスポート導線

### D. 活用価値アップ
- 価格推移グラフ
- 店舗別平均価格
- 値上げアラート
- CSV出力

---

## 4) 段階的リリース（衝突しにくい実装順）

### 第1段階（まず体験を整える）
1. 商品サジェスト
2. カテゴリー初期設定
3. 入力文言のやさしい改善

### 第2段階（運用を速くする）
1. バーコード読み取り
2. 「前回と同じで登録」
3. ローカルバックアップ導線の改善

### 第3段階（差別化）
1. 写真からの商品判別（AI候補表示）
2. 判別結果の学習（よく使う修正を優先提案）

---

## 5) 4週間ロードマップ（実務向け）

### Week 1
- データモデル拡張（容量・税区分・単価）
- 既存データ互換処理
- 入力UI微調整

### Week 2
- 商品サジェスト
- 前回値再利用
- 「前回と同じで登録」

### Week 3
- IndexedDB移行
- バックアップ導線改善
- 画像データ保存方針の最適化

### Week 4
- 推移グラフ
- 値上げアラート
- CSV出力

---

## 6) KPI（改善効果の測定）
- 1件登録の平均時間
- 週あたり登録件数（継続率）
- 底値購入率
- バックアップ実施率
- データ消失報告件数

---

## 7) まず着手するMVP+
1. 単価比較（容量対応）
2. 商品名サジェスト
3. IndexedDB移行 + バックアップ導線

この3点で、**使いやすさ / 比較精度 / 安心感**を同時に改善します。

---

## 8) 最後に（このプランの目標）
この改善プランの目標は次の3つです。

- だれでもすぐ使える
- 買い物中に迷わない
- 比較が正確で節約につながる

**直感的で、やさしく、安心して使える iPhone/PWA家計補助アプリ**を目指します。
# 底値メモ: 現状整理と改善提案

## 1. 現在できること（現状機能）

### 記録・閲覧
- 商品名 / 店舗 / 価格 / 単位 / 日付 / メモを登録できる
- 一覧で検索（商品名・店舗）とソート（新しい順、古い順、安い順、高い順）ができる
- 店舗チップで店舗フィルターができる
- 商品名ごとに最安値を自動判定し「底値」ラベル表示できる

### 編集・管理
- 詳細モーダルから編集・削除できる
- localStorage に保存され、アプリ再起動後も保持される
- JSON エクスポート / インポートができる
- 全件削除ができる

### 利用形態
- PWA（manifest + service worker）としてオフライン利用を想定した構成

## 2. すぐ効く改善（優先度: 高）

### A. データモデル改善（価格比較の精度アップ）
現状は「商品名」が同じなら最安値比較されるため、容量違い・規格違いを比較してしまう可能性があります。

**提案**
- `容量（g/ml/個数）` と `税込/税抜` フラグを追加
- 100g単価 / 1個単価の自動計算フィールドを追加
- 「実売価格」と「単価」を切り替えて最安値判定

**効果**
- 底値判定が実用的になり、買い物判断の質が上がる

### B. 入力体験の改善（登録速度アップ）
**提案**
- 前回入力値（店舗・単位）をデフォルト再利用
- 商品名のサジェスト（過去登録履歴）
- 「よく買う商品」ピン留め
- 数値キーパッド最適化（価格・容量）

**効果**
- 買い物中の片手操作での登録時間を短縮

### C. データ保全（消失リスク対策）
localStorage 依存は端末消去・ブラウザ設定変更の影響を受けます。

**提案**
- IndexedDB への移行（容量・信頼性改善）
- 自動バックアップ通知（例: 月1回）
- 任意クラウド同期（Google Drive / iCloud Drive 経由のファイル連携）

**効果**
- 長期運用時の安心感が上がる

## 3. 次の成長施策（優先度: 中）

### D. 分析ダッシュボード
**提案**
- 商品ごとの価格推移グラフ
- 店舗別の平均価格比較
- 値上げアラート（直近n回平均比 +x%）

**効果**
- 「どこで買うべきか」「いつ買うべきか」の意思決定が早くなる

### E. 買い物モード
**提案**
- 買い物リスト連携（必要商品だけを表示）
- 現在地に近い店舗表示（任意許可）
- チェック時に「今回価格」を即記録

**効果**
- 記録アプリから「行動支援アプリ」へ進化

### F. 共有・家計連携
**提案**
- 家族とデータ共有（読み書き権限）
- CSV出力（家計簿アプリ取り込み）
- 月次節約レポート（底値購入率）

**効果**
- 単独メモ用途から家庭運用へ拡張可能

## 4. 品質改善（優先度: 中）

### G. PWAの仕上げ
**提案**
- アイコンパス・キャッシュ対象の整合性確認
- バージョン更新時のキャッシュ更新導線（更新通知）
- オフライン時エラーハンドリングの明確化

### H. アクセシビリティ
**提案**
- コントラスト比再点検
- フォームラベルとフォーカス順序の改善
- 音声読み上げ向けのaria属性補強

### I. テスト整備
**提案**
- 登録 / 編集 / 削除 / インポートの主要フローE2E
- 価格計算ロジックのユニットテスト

## 5. 実装ロードマップ（4週間案）

### Week 1: 基盤
- データモデル拡張（容量・税区分・単価）
- 既存データマイグレーション
- 主要フォーム改善

### Week 2: 価値機能
- 単価比較UI
- 商品サジェスト
- よく買う商品ピン留め

### Week 3: 安定性
- IndexedDB移行
- 自動バックアップ導線
- PWA更新通知

### Week 4: 差別化
- 価格推移グラフ
- 値上げアラート
- CSV出力

## 6. KPI（改善効果の測定）
- 1件登録にかかる平均秒数
- 週あたり記録件数（継続率）
- 底値購入率
- バックアップ実施率
- データ消失報告件数

---

## まず着手すべき最小セット（MVP+）
1. 単価比較（容量追加）
2. 商品名サジェスト
3. IndexedDB移行 + バックアップ導線

この3点だけで、**「使いやすさ」「判断精度」「安心感」**が大きく向上します。
